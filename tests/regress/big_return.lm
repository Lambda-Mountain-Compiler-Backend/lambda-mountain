
import LIB/default.lm;

type XY X | (Y( U64 ));
type XYZ (Z( XY , U64 ));

f := λ(: x U64)(: y U64). (: (tail(
   (let buffer 555_u64)
   (print 'F1_s)
   (let xyz (Z( (Y( x )) y )))
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Z>)))
   (let xy (.2 (as xyz Tag<Z>)))
   (print (.0 xy))
   (print (.1(as xy Tag<Y>)))
   (print '\n_s)
   xyz
)) XYZ);

f2 := λ(: x U64). (: (tail(
   (let buffer 555_u64)
   (print 'F2_s)
   (let xyz (Z( (Y( x )) 456_u64 )))
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Z>)))
   (let xy (.2 (as xyz Tag<Z>)))
   (print (.0 xy))
   (print (.1(as xy Tag<Y>)))
   (print '\n_s)
   xyz
)) XYZ);

f3 := λ(: x U64)(: y U64). (: (tail(
   (let buffer 555_u64)
   (print 'F3_s)
   (let xyz (Y( x )))
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Y>)))
   (print '\n_s)
   xyz
)) XY);

f4 := λ(: x U64). (: (tail(
   (let buffer 555_u64)
   (print 'F4_s)
   (let xyz (Y( x )))
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Y>)))
   (print '\n_s)
   xyz
)) XY);

f5 := λ(: xyz XYZ). (: (tail(
   (print 'F5_s)
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Z>)))
   (let xy (.2 (as xyz Tag<Z>)))
   (print (.0 xy))
   (print (.1(as xy Tag<Y>)))
   (print '\n_s)
   xyz
)) XYZ);

f6 := λ(: abc XYZ). (: (tail(
   (let xyz (Z( (Y( 123_u64 )) 456_u64 )))
   (print 'F6_s)
   (print (.0 xyz))
   (print (.1 (as xyz Tag<Z>)))
   (let xy (.2 (as xyz Tag<Z>)))
   (print (.0 xy))
   (print (.1(as xy Tag<Y>)))
   (print '\n_s)
   xyz
)) XYZ);

main := λ. (: (tail(
  (let xyz (f( 123_u64 456_u64 )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Z>)))
  (let xy (.2 (as xyz Tag<Z>)))
  (print (.0 xy))
  (print (.1(as xy Tag<Y>)))
  (print '\n_s)
  (match (f( 123_u64 456_u64 )) (
     ()
     ( (Z( (Y( x )) y )) (tail(
        (print x)
        (print y)
        (print '\n_s)
     )))
  ))
  (let xyz (f3( 123_u64 456_u64 )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Y>)))
  (match (f3( 123_u64 456_u64 )) (
     ()
     ( (Y( x )) (tail(
        (print x)
        (print '\n_s)
     )))
  ))
  (let xyz (f4( 123_u64 )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Y>)))
  (match (f4( 123_u64 )) (
     ()
     ( (Y( x )) (tail(
        (print x)
        (print '\n_s)
     )))
  ))
  (let xyz (f2( 123_u64 )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Z>)))
  (let xy (.2 (as xyz Tag<Z>)))
  (print (.0 xy))
  (print (.1(as xy Tag<Y>)))
  (print '\n_s)
  (match (f2( 123_u64 )) (
     ()
     ( (Z( (Y( x )) y )) (tail(
        (print x)
        (print y)
        (print '\n_s)
     )))
  ))
  (let xyz (f5( (Z( (Y( 123_u64 )) 456_u64 )) )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Z>)))
  (let xy (.2 (as xyz Tag<Z>)))
  (print (.0 xy))
  (print (.1(as xy Tag<Y>)))
  (print '\n_s)
  (let xyz (f6( (Z( (Y( 777_u64 )) 888_u64 )) )))
  (print (.0 xyz))
  (print (.1 (as xyz Tag<Z>)))
  (let xy (.2 (as xyz Tag<Z>)))
  (print (.0 xy))
  (print (.1(as xy Tag<Y>)))
  (print '\n_s)
)) Nil);

