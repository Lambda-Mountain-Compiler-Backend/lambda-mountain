
with-tag := Î»(: tt Type). (: (
   (let cls-tt (with-only-class tt))
   (if (non-zero cls-tt) (
      (match cls-tt (
         ()
         ( (TGround( cls tl )) (
            (let tag (get-only-child cls))
            (if (head-string tag) (
               (set tt (and( tt (t2( 'Tag_s (t1 tag) )) )))
               (set tt (and( tt (t2( 'CaseNumber_s (t1(to-string(index-of-tag tag))) )) )))
            ) ())
         ))
         ( _ () )
      ))
   ) ())
   tt
) Type);
